--DELETE FROM dbo.DE_LocalDevelopmentFinance
--DBCC CHECKIDENT(DE_LocalDevelopmentFinance ,RESEED , 0)

--INSERT  INTO dbo.DE_LocalDevelopmentFinance
--        ( CountryID ,
--          Name ,
--          ShortName ,
--          InvestmentProjectName ,
--          ProgrammeInstanceID ,
--          ProjectInstanceID ,
--          InitiateYear ,
--          CompleteYear ,
--          DescriptionInvestmentProject ,
--          DivisionRegionProvince ,
--          SecondOrderAdministrativeUnit ,
--          LowestAdministrativeUnit ,
--          LatitudeGeographicCoordinate ,
--          LongitudeGeographicCoordinate ,
--          UNCDFGrants_USD ,
--          UNCDFLoans_USD ,
--          UNCDFGuarantees_USD ,
--          UNCDFReimbursableGrants_USD ,
--          WasDualKeySystemUsedYesNoID ,
--          FinancingInstrumentID ,
--          TypeOfImplementationPartner ,
--          NationalGovernmentContribution_USD ,
--          LocalLevelContribution_USD ,
--          DomesticFinancialInstitutionContribution_USD ,
--          DevelopmentPartnersContribution_USD ,
--          ContributionOthers_USD ,
--          SectorImpactID ,
--          SubSectorImpact ,
--          InvestmentTypeID ,
--          DescriptionFromInvestmentProject ,
--          NumberOfDirectBeneficiariesFemale ,
--          NumberOfDirectBeneficiariesMale ,
--          AdditionalComment		  
--        )
--        SELECT  TRY_CAST(CountryID AS INT) ,
--                [Programme Name*] ,
--                [Programme Name*] ,
--                [Investment project name*] ,
--                TRY_CAST(ProgrammeInstanceID AS INT) ,
--                TRY_CAST(ProjectInstanceID AS INT) ,
--                TRY_CAST([Year Initated] AS INT) ,
--                TRY_CAST([Year Completed*] AS INT) ,
--                [Description Investment project] ,
--                [Division/Region/Province*] ,
--                [Second Order Administrative Unit (municipality/LG/district)] ,
--                [Lowest Administrative Unit] ,
--                TRY_CAST(CASE WHEN TRY_CAST([Latitude-Geographic Coordinates] AS DECIMAL(18,
--                                                              10)) IS NULL
--                     THEN CASE WHEN CHARINDEX(',',
--                                              [Latitude-Geographic Coordinates]) > 0
--                               THEN SUBSTRING([Latitude-Geographic Coordinates],
--                                              0,
--                                              CHARINDEX(',',
--                                                        [Latitude-Geographic Coordinates]))
--                               ELSE SUBSTRING([Latitude-Geographic Coordinates],
--                                              0,
--                                              CHARINDEX(' ',
--                                                        [Latitude-Geographic Coordinates]))
--                          END
--                     WHEN [Latitude-Geographic Coordinates] = 'N.A' THEN NULL
--                     ELSE [Latitude-Geographic Coordinates]
--                END AS DECIMAL(18,10))AS l1 ,
--                TRY_CAST(CASE WHEN TRY_CAST([Longitude-Geographic Coordinates] AS DECIMAL(18,
--                                                              10)) IS NULL
--                     THEN CASE WHEN CHARINDEX(',',
--                                              [Longitude-Geographic Coordinates]) > 0
--                               THEN SUBSTRING([Longitude-Geographic Coordinates],
--                                              0,
--                                              CHARINDEX(',',
--                                                        [Longitude-Geographic Coordinates]))
--                               ELSE SUBSTRING([Longitude-Geographic Coordinates],
--                                              0,
--                                              CHARINDEX(' ',
--                                                        [Longitude-Geographic Coordinates]))
--                          END
--                     WHEN [Longitude-Geographic Coordinates] = 'N.A' THEN NULL
--                     ELSE [Longitude-Geographic Coordinates]
--                END AS DECIMAL(18,10)) AS l2 ,
--                TRY_CAST([UNCDF grants (USD)] AS DECIMAL(18, 10)) ,
--                TRY_CAST([UNCDF loans (USD)] AS DECIMAL(18, 10)) ,
--                TRY_CAST([UNCDF guarantees (USD)] AS DECIMAL(18, 10)) ,
--                TRY_CAST([UNCDF reimbursable grants (USD)] AS DECIMAL(18, 10)) ,
--                CASE WHEN [Was dual key system used? (Y/N)*] = 'N' THEN 0
--                     WHEN [Was dual key system used? (Y/N)*] = 'Y' THEN 1
--                END ,
--                TRY_CAST(FinancingInstrumentID AS INT) ,
--                [Type of implementation partner (e#g# Local Gov, SMEs, Others)*] ,
--                TRY_CAST([National Government contribution (USD)] AS DECIMAL(18,
--                                                              10)) ,
--                TRY_CAST([Local-level Contribution (USD) ] AS DECIMAL(18, 10)) ,
--                TRY_CAST([Domestic financial institution contribution (USD)] AS DECIMAL(18,
--                                                              10)) ,
--                TRY_CAST([Development partners contribution (USD)] AS DECIMAL(18,
--                                                              10)) ,
--                TRY_CAST([Contribution others (USD)] AS DECIMAL(18, 10)) ,
--                TRY_CAST(SectorImpactID AS INT) ,
--                [Sub-Impact Sector] ,
--                TRY_CAST(InvestmentTypeID AS INT) ,
--                [Description of development impact from investment project (verif] ,
--                TRY_CAST([Number of direct beneficiaries (female)] AS INT) ,
--                TRY_CAST([Number of direct beneficaries (men)] AS INT) ,
--                [Additional comments]
--        FROM    dbo._LDF2
--                JOIN dbo.C_Country ON _LDF2.[Country*] = dbo.C_Country.Name_ENG
--GO
--UPDATE dbo.DE_LocalDevelopmentFinance
--SET LocalDevelopmentFinanceInstanceID = LocalDevelopmentFinanceID

--INSERT INTO dbo.DE_LocalDevelopmentFinancePublishedItem
--        ( LocalDevelopmentFinanceID ,
--          LocalDevelopmentFinanceInstanceID
--        )
--SELECT LocalDevelopmentFinanceID ,LocalDevelopmentFinanceInstanceID
--FROM dbo.DE_LocalDevelopmentFinance

-- Data-um lcnely

--INSERT INTO dbo.LocalDevelopmentFinance
--        ( LocalDevelopmentFinanceID ,
--          ID ,
--          IDInSource ,
--          CountryID ,
--          Name ,
--          ShortName ,
--          Description ,
--          StatusID ,
--          ProgrammeID ,
--          Location1ID ,
--          AdministrativeTerritoryID ,
--          LongitudeGeographicCoordinate ,
--          LatitudeGeographicCoordinate ,
--          UNCDFGrants_USD ,
--          NationalGovernmentContribution_USD ,
--          Local ,
--          ContributionOthers_USD ,
--          CurrencyID ,
--          SectorImpactID ,
--          InvestmentTypeID ,
--          ResultsOfTheProjectImpact ,
--          FinancingInstrumentID ,
--          DateUpdated ,
--          UpdatedUserID ,
--          MajorVersion ,
--          MinorVersion ,
--          OwnerUserID ,
--          DateCreated ,
--          CreatedUserID ,
--          InvestmentProjectName ,
--          ProjectID ,
--          InitiateYear ,
--          CompleteYear ,
--          DescriptionInvestmentProject ,
--          DivisionRegionProvince ,
--          SecondOrderAdministrativeUnit ,
--          LowestAdministrativeUnit ,
--          NumberOfDirectBeneficiariesMale ,
--          NumberOfDirectBeneficiariesFemale ,
--          UNCDFLoans_USD ,
--          UNCDFGuarantees_USD ,
--          UNCDFReimbursableGrants_USD ,
--          WasDualKeySystemUsedYesNoID ,
--          TypeOfImplementationPartner ,
--          LocalLevelContribution_USD ,
--          DomesticFinancialInstitutionContribution_USD ,
--          DevelopmentPartnersContribution_USD ,
--          SectorImpact ,
--          DescriptionFromInvestmentProject ,
--          AdditionalComment
--        )
--SELECT a.LocalDevelopmentFinanceID ,
--       a.ID ,
--       a.IDInSource ,
--       a.CountryID ,
--       a.Name ,
--       a.ShortName ,
--       a.Description ,
--       a.StatusID ,
--       a.ProgrammeInstanceID ,
--       a.Location1ID ,
--       a.AdministrativeTerritoryID ,
--       a.LongitudeGeographicCoordinate ,
--       a.LatitudeGeographicCoordinate ,
--       a.UNCDFGrants_USD ,
--       a.NationalGovernmentContribution_USD ,
--       a.Local ,
--       a.ContributionOthers_USD ,
--       a.CurrencyID ,
--       a.SectorImpactID ,
--       a.InvestmentTypeID ,
--       a.ResultsOfTheProjectImpact ,
--       a.FinancingInstrumentID ,
--       a.DateUpdated ,
--       a.UpdatedUserID ,
--       a.MajorVersion ,
--       a.MinorVersion ,
--       a.OwnerUserID ,
--	   b.DateCreated,
--	   b.CreatedUserID,
--	   a.InvestmentProjectName ,
--       a.ProjectInstanceID ,
--       a.InitiateYear ,
--       a.CompleteYear ,
--       a.DescriptionInvestmentProject ,
--       a.DivisionRegionProvince ,
--       a.SecondOrderAdministrativeUnit ,
--       a.LowestAdministrativeUnit ,
--       a.NumberOfDirectBeneficiariesMale ,
--       a.NumberOfDirectBeneficiariesFemale ,
--       a.UNCDFLoans_USD ,
--       a.UNCDFGuarantees_USD ,
--       a.UNCDFReimbursableGrants_USD ,
--       a.WasDualKeySystemUsedYesNoID ,
--       a.TypeOfImplementationPartner ,
--       a.LocalLevelContribution_USD ,
--       a.DomesticFinancialInstitutionContribution_USD ,
--       a.DevelopmentPartnersContribution_USD ,
--       a.SubSectorImpact ,
--       a.DescriptionFromInvestmentProject ,
--       a.AdditionalComment
--FROM dbo.DE_LocalDevelopmentFinance AS a
--JOIN dbo.DE_LocalDevelopmentFinancePublishedItem AS b ON b.LocalDevelopmentFinanceID = a.LocalDevelopmentFinanceID
